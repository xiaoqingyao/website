<HTML> <HEAD> <meta http-equiv="Content-Type" content="text/html; charset=GB2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../language/"+lang.ad+".css' type='text/css' rel='stylesheet'>");document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");document.write("<title>"+lang["DlgHylnk"]+"</title>");var V=av['action'];var K=lang["DlgComInsert"];var jc;var oRange;var bl;var aM;var aY="http://";var fj="http://";var eg="";switch(V){case "other":aY=dialogArguments.hk.Href;eg=dialogArguments.hk.Target;fj=lN(aY);jc=dialogArguments.opener;break;default:oRange=dialogArguments.eWebEditor.document.selection.createRange();bl=dialogArguments.eWebEditor.document.selection.type;if(bl=="Control"){aM=oRange(0).parentNode;}else{aM=oRange.parentElement();}var nF=ea(aM,"A");if(nF){aM=nF;}if(aM.tagName.toUpperCase()=="A"){eg=aM.target;aY=aM.getAttribute("href",2);fj=lN(aY);}jc=dialogArguments;break;}function ea(B,bE){while(B!=null&&B.tagName!=bE){B=B.parentElement;}return B;};function lN(url){var ab=/(.+:\/*)(.*)/gi;return url.replace(ab,"$1");};function mC(index){fj=d_protocol.options[index].value;aY=d_url.value;var ab=/(.+:\/*)/gi;aY=aY.replace(ab,"");d_url.value=fj+aY;};function J(){lang.aD(document);ay(d_protocol,fj.toLowerCase());ay(d_target,eg.toLowerCase());iY();d_url.value=aY;aE();};function iY(){d_anchor.options.length=1;var ba=jc.eWebEditor.document.body.getElementsByTagName("A");for(i=0;i<ba.length;i++){if(ba[i].href.toUpperCase()==""){d_anchor.options[d_anchor.options.length]=new Option(ba[i].name,"#"+ba[i].name);}}};function ac(){aY=d_url.value;fj=d_protocol.options[d_protocol.selectedIndex].value;eg=d_target.options[d_target.selectedIndex].value;if(aY!=""){switch(V){case "other":var Q=new Array();Q[0]=aY;Q[1]=eg;window.returnValue=Q;break;default:oRange.execCommand("CreateLink",false,aY);oRange=dialogArguments.eWebEditor.document.selection.createRange();bl=dialogArguments.eWebEditor.document.selection.type;if(bl=="Control"){aM=oRange(0).parentNode;}else{aM=oRange.parentElement();}var nF=ea(aM,"A");if(nF){aM=nF;}if(eg!=""){aM.target=eg;}else{aM.removeAttribute("target");}window.returnValue=null;break;}}else{alert(lang["DlgHylnkNoUrl"]);d_url.focus();return;}window.close();}</script> </HEAD> <body onload="J()"> <table border=0 cellpadding=0 cellspacing=5 id=ar><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <legend><span lang=DlgHylnkLegend></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <tr> <td noWrap width="20%"><span lang=DlgHylnkProtocol></span>:</td> <td noWrap width="29%"> <select id=d_protocol onchange="mC(this.selectedIndex)" size=1 style="width:80px"> <option value='' lang=DlgComOther></option> <option value='file://'>file:</option> <option value='ftp://'>ftp:</option> <option value='gopher://'>gopher:</option> <option value='http://'>http:</option> <option value='https://'>https:</option> <option value='mailto:'>mailto:</option> <option value='news:'>news:</option> <option value='telnet:'>telnet:</option> <option value='wais:'>wais:</option> </select> </td> <td width="2%">&nbsp;</td> <td noWrap width="20%"><span lang=DlgHylnkTarget></span>:</td> <td noWrap width="29%"> <select id=d_target size=1 style="width:80px"> <option value='' lang=DlgHylnkTargetNone></option> <option value='_self' lang=DlgHylnkTargetSelf></option> <option value='_top' lang=DlgHylnkTargetTop></option> <option value='_blank' lang=DlgHylnkTargetBlank></option> <option value='_parent' lang=DlgHylnkTargetParent></option> </select> </td> </tr> <tr> <td noWrap width="20%"><span lang=DlgHylnkUrl></span>:</td> <td noWrap width="80%" colspan=4><input type=text id=d_url size=10 value="" style="width:100%"></td> </tr> <tr> <td noWrap width="20%"><span lang=DlgHylnkAnchor></span>:</td> <td noWrap width="80%" colspan=4> <select id=d_anchor onchange="d_url.value=this.options[this.selectedIndex].value" size=1 style="width:100%"> <option value='' lang=DlgHylnkAnchorNone></option> </select> </td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr><td noWrap align=right><input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ac()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel></td></tr> </table> </td></tr></table> </BODY> </HTML> 