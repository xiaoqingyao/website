<html>
    
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=GB2312">
        <script type="text/javascript" src="dialog.js">
        </script>
        <script type="text/javascript">
            document.write("<link href='../language/" + lang.ad + ".css' type='text/css' rel='stylesheet'>");
            document.write("<link href='../skin/" + config.Skin + "/dialog.css' type='text/css' rel='stylesheet'>");
            var V = "INSERT";
            var K = lang["DlgComInsert"];
            var A;
            var ey;
            var aN;
            var aG = "http://";
            var eZ = "";
            var bS = "0";
            var aH = "";
            var fg = "";
            var aS = "";
            var T = "";
            var U = "";
            var bI = "";
            var bG = "";
            var bX = "";
            var bt = "file";
            var aJ = ((parseFloat(config.AllowImageSize) > 0) ? true : false);
            var lQ = (((config.SYWZFlag == "2") || (config.SYTPFlag == "2")) ? true : false);
            R = dialogArguments.eWebEditor.document.selection.createRange();
            aN = dialogArguments.eWebEditor.document.selection.type;
            if (aN == "Control") {
                if (R.item(0).tagName == "IMG") {
                    V = "MODI";
                    K = lang["DlgComModify"];
                    bt = "url";
                    A = R.item(0);
                    aG = A.getAttribute("src", 2);
                    eZ = A.alt;
                    bS = A.border;
                    aH = A.style.borderColor;
                    fg = A.style.filter;
                    aS = A.align;
                    T = A.width;
                    U = A.height;
                    bI = A.vspace;
                    bG = A.hspace;
                }
            }
            document.write("<title>" + lang["DlgImg"] + "(" + K + ")</title>");
            function J() {
                lang.aD(document);
                ay(d_filter, fg);
                ay(d_align, aS.toLowerCase());
                if (!aJ) {
                    bt = "url";
                }
                ax(bt);
                d_fromurl.value = aG;
                d_alt.value = eZ;
                d_border.value = bS;
                d_bordercolor.value = aH;
                s_bordercolor.style.backgroundColor = aH;
                d_width.value = T;
                d_height.value = U;
                d_vspace.value = bI;
                d_hspace.value = bG;
                ct();
                aE();
            };
            function ax(al) {
                if (al == "url") {
                    d_fromurl.disabled = false;
                    if (config.AllowBrowse == "1") {
                        d_browse.disabled = false;
                    }
                    d_checkfromurl.checked = true;
                    if (aJ) {
                        d_checkfromfile.checked = false;
                        document.myuploadform.uploadfile.disabled = true;
                    }
                } else {
                    d_checkfromurl.checked = false;
                    document.myuploadform.uploadfile.disabled = false;
                    d_checkfromfile.checked = true;
                    d_fromurl.disabled = true;
                    if (config.AllowBrowse == "1") {
                        d_browse.disabled = true;
                    }
                }
            };
            function UploadError(aT) {
                cp();
                ax('file');
                ah.style.display = "none";
                try {
                    aQ(document.myuploadform.uploadfile, fo(aT, config.AllowImageExt, config.AllowImageSize));
                } catch (e) { }
            };
            function UploadSaved(co, hn) {
                d_fromurl.value = co;
                bX = hn;
                bi();
            };
            function bi() {
                aG = d_fromurl.value;
                eZ = d_alt.value;
                bS = d_border.value;
                aH = d_bordercolor.value;
                fg = d_filter.options[d_filter.selectedIndex].value;
                aS = d_align.value;
                T = d_width.value;
                U = d_height.value;
                bI = d_vspace.value;
                bG = d_hspace.value;
                if (V == "MODI") {
                    if (bX) {
                        A.src = bX;
                    } else {
                        A.src = aG;
                    }
                    A.alt = eZ;
                    A.border = bS;
                    A.style.borderColor = aH;
                    A.style.filter = fg;
                    A.align = aS;
                    A.width = T;
                    A.height = U;
                    A.style.width = T;
                    A.style.height = U;
                    A.vspace = bI;
                    A.hspace = bG;
                    if (bX) {
                        R.execCommand("CreateLink", false, aG);
                        var aM = R(0).parentNode;
                        aM.target = "_blank";
                    }
                } else {
                    var as = '';
                    if (fg != "") {
                        as = as + 'filter:' + fg + ';';
                    }
                    if (aH != "") {
                        as = as + 'border-color:' + aH + ';';
                    }
                    if (as != "") {
                        as = ' style="' + as + '"';
                    }
                    if (bX) {
                        as = '<img id=eWebEditor_TempElement_Img src="' + bX + '"' + as;
                    } else {
                        as = '<img id=eWebEditor_TempElement_Img src="' + aG + '"' + as;
                    }
                    if (bS != "") {
                        as = as + ' border="' + bS + '"';
                    }
                    if (eZ != "") {
                        as = as + ' alt="' + eZ + '"';
                    }
                    if (aS != "") {
                        as = as + ' align="' + aS + '"';
                    }
                    if (T != "") {
                        as = as + ' width="' + T + '"';
                    }
                    if (U != "") {
                        as = as + ' height="' + U + '"';
                    }
                    if (bI != "") {
                        as = as + ' vspace="' + bI + '"';
                    }
                    if (bG != "") {
                        as = as + ' hspace="' + bG + '"';
                    }
                    as = as + '>';
                    if (bX) {
                        as = '<a id=eWebEditor_TempElement_Img_Href href="' + aG + '" target="_blank">' + as + '</a>';
                    }
                    dialogArguments.insertHTML(as);
                    var aB = dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Img");
                    if (bX) {
                        aB.src = bX;
                        var jl = dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Img_Href");
                        jl.setAttribute("href", aG);
                        jl.removeAttribute("id");
                    } else {
                        aB.src = aG;
                    }
                    aB.removeAttribute("id");
                }
                window.returnValue = null;
                window.close();
            };
            var hq = "";
            function ac() {
                d_border.value = bz(d_border.value);
                d_width.value = bz(d_width.value);
                d_height.value = bz(d_height.value);
                d_vspace.value = bz(d_vspace.value);
                d_hspace.value = bz(d_hspace.value);
                if (!cw(d_bordercolor.value)) {
                    aQ(d_bordercolor, lang["DlgImgErrBorColor"]);
                    return false;
                }
                if (d_checkfromurl.checked) {
                    bi();
                } else {
                    if (!dU(document.myuploadform.uploadfile.value, config.AllowImageExt)) {
                        UploadError("ext");
                        return false;
                    }
                    cf();
                    ah.style.display = "";
                    if (lQ) {
                        if (hq == "") {
                            hq = document.myuploadform.action;
                        }
                        if (d_syflag.checked) {
                            document.myuploadform.action = hq + "&syflag=1";
                        } else {
                            document.myuploadform.action = hq;
                        }
                    }
                    document.myuploadform.submit();
                }
            };
            function cf() {
                d_checkfromfile.disabled = true;
                d_checkfromurl.disabled = true;
                d_fromurl.disabled = true;
                if (config.AllowBrowse == "1") {
                    d_browse.disabled = true;
                }
                d_alt.disabled = true;
                d_border.disabled = true;
                d_bordercolor.disabled = true;
                d_filter.disabled = true;
                d_align.disabled = true;
                d_width.disabled = true;
                d_height.disabled = true;
                d_vspace.disabled = true;
                d_hspace.disabled = true;
                Ok.disabled = true;
            };
            function cp() {
                d_checkfromfile.disabled = false;
                d_checkfromurl.disabled = false;
                d_fromurl.disabled = false;
                if (config.AllowBrowse == "1") {
                    d_browse.disabled = false;
                }
                d_alt.disabled = false;
                d_border.disabled = false;
                d_bordercolor.disabled = false;
                d_filter.disabled = false;
                d_align.disabled = false;
                d_width.disabled = false;
                d_height.disabled = false;
                d_vspace.disabled = false;
                d_hspace.disabled = false;
                Ok.disabled = false;
            };
            function ct() {
                var url;
                if (d_checkfromurl.checked) {
                    url = d_fromurl.value;
                    if (config.BaseHref != "") {
                        url = config.BaseHref + url;
                    }
                } else {
                    url = document.myuploadform.uploadfile.value;
                }
                if (url.lastIndexOf(".") <= 0) {
                    lO();
                    return;
                }
                var lx = false;
                if ((aJ) && (aq.kq || aq.IsIE8)) {
                    if (d_checkfromfile.checked) {
                        lx = true;
                    }
                }
                if (url) {
                    if (lx) {
                        mY(url);
                    } else {
                        eh.src = url;
                    }
                } else {
                    tdPreview.innerHTML = "";
                }
            };
            function mX() {
                var width = eh.width;
                var height = eh.height;
                if (eh.src) {
                    var ix = tdPreview.offsetWidth;
                    var iL = tdPreview.offsetHeight;
                    if ((width > ix) || (height > iL)) {
                        var nw = ix / width;
                        var dN = iL / height;
                        if (nw > dN) {
                            height = iL;
                            width = width * dN;
                        } else {
                            width = ix;
                            height = height * nw;
                        }
                    }
                    tdPreview.innerHTML = "<img border=0 src='" + eh.src + "' width='" + width + "' height='" + height + "' style=\"filter:" + d_filter.value + "\">";
                    tdPreviewSize.innerHTML = eh.width + " * " + eh.height;
                }
            };
            function lO() {
                tdPreview.innerHTML = "";
                tdPreviewSize.innerHTML = "";
            };
            function mY(url) {
                var bT = tdPreview.offsetWidth;
                var cF = tdPreview.offsetHeight;
                tdPreview.innerHTML = "<div id=eT style=\"filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=image) " + d_filter.value + ";WIDTH:10px; HEIGHT:10px;\"></div>";
                eT.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = url;
                var w = eT.offsetWidth;
                var h = eT.offsetHeight;
                var sw, bU;
                if ((w > bT) || (h > cF)) {
                    var nw = bT / w;
                    var dN = cF / h;
                    if (nw > dN) {
                        bU = cF;
                        sw = w * dN;
                    } else {
                        sw = bT;
                        bU = h * nw;
                    }
                } else {
                    sw = w;
                    bU = h;
                }
                eT.style.width = sw;
                eT.style.height = bU;
                eT.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").sizingMethod = 'scale';
                tdPreviewSize.innerHTML = w + " * " + h;
            }
        </script>
        
        <BODY onload="J()">
            <table border=0 cellpadding=0 cellspacing=5 id=ar>
                <tr>
                    <td>
                        <table border=0 cellpadding=0 cellspacing=5 align=center>
                            <tr valign=top>
                                <td width="60%">
                                    <table border=0 cellpadding=0 cellspacing=0 align=center width="100%">
                                        <tr>
                                            <td>
                                                <fieldset>
                                                    <legend>
                                                        <span lang=DlgImgSource>
                                                        </span>
                                                    </legend>
                                                    <table border=0 cellpadding=5 cellspacing=0 width="100%">
                                                        <tr>
                                                            <td>
                                                                <table border=0 cellpadding=0 cellspacing=0 width="300px">
                                                                    <tr>
                                                                        <td>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                                <table border=0 cellpadding=0 cellspacing=2 width="100%">
                                                                    <script type="text/javascript">
                                                                        if (aJ) {
                                                                            document.write("<tr>");
                                                                            document.write("<td noWrap width=\"20%\"><input type=radio id=\"d_checkfromfile\" value=\"1\" onclick=\"ax('file')\"><label for=d_checkfromfile>" + lang["DlgFromFile"] + "</label>:</td>");
                                                                            document.write("<td noWrap width=\"80%\">");
                                                                            document.write(fG("image"));
                                                                            document.write("</td>");
                                                                            document.write("</tr>");
                                                                        }
                                                                    </script>
                                                                    <tr>
                                                                        <td noWrap width="20%">
                                                                            <input type=radio id="d_checkfromurl" value="1" onclick="ax('url')">
                                                                            <label for=d_checkfromurl>
                                                                                <span lang=DlgFromUrl>
                                                                                </span>
                                                                            </label>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="80%">
                                                                            <script type="text/javascript">
                                                                                if (config.AllowBrowse == "1") {
                                                                                    document.write("<table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td width='100%'><input type=text id='d_fromurl' style='width:100%' size=20 value='' onpropertychange=\"if (event.propertyName=='value'){ct()}\"></td><td><input class='dlgBtnBrowse' type=button id='d_browse' onclick=\"fA('image','fromurl')\" value='" + lang["DlgBtnBrowse"] + "' align=absmiddle></td></tr></table>");
                                                                                } else {
                                                                                    document.write("<input type=text id='d_fromurl' style='width:100%' size=30 value='' onpropertychange=\"if (event.propertyName=='value'){ct()}\">");
                                                                                }
                                                                            </script>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </fieldset>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td height=5>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <fieldset>
                                                    <legend>
                                                        <span lang=DlgImgEffect>
                                                        </span>
                                                    </legend>
                                                    <table border=0 cellpadding=5 cellspacing=0 width="100%">
                                                        <tr>
                                                            <td>
                                                                <table border=0 cellpadding=0 cellspacing=2 width="100%">
                                                                    <tr>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgAlt>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="80%" colspan=4>
                                                                            <input type=text id=d_alt size=10 value="" style="width:100%">
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgBorder>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <input style="width:80px" type=text id=d_border size=10 value="" ONKEYPRESS="event.returnValue=aP();">
                                                                        </td>
                                                                        <td width="2%">
                                                                            &nbsp;
                                                                        </td>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgBorderColor>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <input style="width:62px" type=text id=d_bordercolor size=7 value="">
                                                                            <img border=0 src="../sysimage/rect.gif" width=18 style="cursor:hand"
                                                                            id=s_bordercolor onclick="cC('bordercolor')" align=absmiddle>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgSpecEffect>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <select id=d_filter size=1 style="width:80px" onchange="ct()">
                                                                                <option value='' selected lang=DlgComNone>
                                                                                </option>
                                                                                <option value='Alpha(Opacity=50)' lang=DlgImgAlpha1>
                                                                                </option>
                                                                                <option value='Alpha(Opacity=0, FinishOpacity=100, Style=1, StartX=0, StartY=0, FinishX=100, FinishY=140)'
                                                                                lang=DlgImgAlpha2>
                                                                                </option>
                                                                                <option value='Alpha(Opacity=10, FinishOpacity=100, Style=2, StartX=30, StartY=30, FinishX=200, FinishY=200)'
                                                                                lang=DlgImgAlpha3>
                                                                                </option>
                                                                                <option value='blur(add=1,direction=14,strength=15)' lang=DlgImgBlur1>
                                                                                </option>
                                                                                <option value='blur(add=true,direction=45,strength=30)' lang=DlgImgBlur2>
                                                                                </option>
                                                                                <option value='Wave(Add=0, Freq=60, LightStrength=1, Phase=0, Strength=3)'
                                                                                lang=DlgImgWave>
                                                                                </option>
                                                                                <option value='gray' lang=DlgImgGray>
                                                                                </option>
                                                                                <option value='Chroma(Color=#FFFFFF)' lang=DlgImgChroma>
                                                                                </option>
                                                                                <option value='DropShadow(Color=#999999, OffX=7, OffY=4, Positive=1)'
                                                                                lang=DlgImgDropShadow>
                                                                                </option>
                                                                                <option value='Shadow(Color=#999999, Direction=45)' lang=DlgImgShadow>
                                                                                </option>
                                                                                <option value='Glow(Color=#ff9900, Strength=5)' lang=DlgImgGlow>
                                                                                </option>
                                                                                <option value='flipv' lang=DlgImgFlipv>
                                                                                </option>
                                                                                <option value='fliph' lang=DlgImgFliph>
                                                                                </option>
                                                                                <option value='grays' lang=DlgImgGrays>
                                                                                </option>
                                                                                <option value='xray' lang=DlgImgXray>
                                                                                </option>
                                                                                <option value='invert' lang=DlgImgInvert>
                                                                                </option>
                                                                            </select>
                                                                        </td>
                                                                        <td width="2%">
                                                                            &nbsp;
                                                                        </td>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgAlign>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <select id=d_align size=1 style="width:80px">
                                                                                <option value='' selected lang=DlgComDefault>
                                                                                </option>
                                                                                <option value='left' lang=DlgAlignLeft>
                                                                                </option>
                                                                                <option value='right' lang=DlgAlignRight>
                                                                                </option>
                                                                                <option value='top' lang=DlgAlignTop>
                                                                                </option>
                                                                                <option value='middle' lang=DlgAlignMiddle>
                                                                                </option>
                                                                                <option value='bottom' lang=DlgAlignBottom>
                                                                                </option>
                                                                                <option value='absmiddle' lang=DlgAlignAbsmiddle>
                                                                                </option>
                                                                                <option value='absbottom' lang=DlgAlignAbsbottom>
                                                                                </option>
                                                                                <option value='baseline' lang=DlgAlignBaseline>
                                                                                </option>
                                                                                <option value='texttop' lang=DlgAlignTexttop>
                                                                                </option>
                                                                            </select>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgWidth>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <input style="width:80px" type=text id=d_width size=10 value="" ONKEYPRESS="event.returnValue=aP();"
                                                                            maxlength=4>
                                                                        </td>
                                                                        <td width="2%">
                                                                            &nbsp;
                                                                        </td>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgHeight>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <input style="width:80px" type=text id=d_height size=10 value="" ONKEYPRESS="event.returnValue=aP();"
                                                                            maxlength=4>
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgVSpace>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <input style="width:80px" type=text id=d_vspace size=10 value="" ONKEYPRESS="event.returnValue=aP();"
                                                                            maxlength=2>
                                                                        </td>
                                                                        <td width="2%">
                                                                            &nbsp;
                                                                        </td>
                                                                        <td noWrap width="20%">
                                                                            <span lang=DlgImgHSpace>
                                                                            </span>
                                                                            :
                                                                        </td>
                                                                        <td noWrap width="29%">
                                                                            <input style="width:80px" type=text id=d_hspace size=10 value="" ONKEYPRESS="event.returnValue=aP();"
                                                                            maxlength=2>
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </fieldset>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td width="40%" height="100%">
                                    <fieldset style="height:100%">
                                        <legend>
                                            <span lang=DlgImgPreview>
                                            </span>
                                        </legend>
                                        <table border=0 cellpadding=0 cellspacing=5 width="200" height="200" valign=top>
                                            <tr>
                                                <td colspan=2 bgcolor=#FFFFFF align=center valign=middle id=tdPreview
                                                height="100%">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td id=tdPreviewSize>
                                                </td>
                                                <td align=right>
                                                    <input type=button id=oW onclick="ct()" lang=DlgImgPreview>
                                                </td>
                                            </tr>
                                        </table>
                                    </fieldset>
                                </td>
                            </tr>
                            <tr>
                                <td noWrap>
                                    <script type="text/javascript">
                                        if (lQ) {
                                            document.write("<input type=checkbox id=d_syflag value='1'><label for=d_syflag><span lang=DlgImgSYFlag></span></label>");
                                        }
                                    </script>
                                </td>
                                <td noWrap align=right>
                                    <input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ac()"
                                    lang=DlgBtnOK>
                                    &nbsp;&nbsp;
                                    <input type=button class="dlgBtnCommon" value='' onclick="window.close();"
                                    lang=DlgBtnCancel>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
            <div id=ah style="width:200px;height:30px;position:absolute;left:70px;top:100px;display:none">
                <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%"
                height="100%">
                    <tr>
                        <td bgcolor=#3A6EA5>
                            <marquee align="middle" behavior="alternate" scrollamount="5">
                                <font color=#FFFFFF>
                                    <span lang=DlgComUploading>
                                    </span>
                                </font>
                            </marquee>
                        </td>
                    </tr>
                </table>
            </div>
            <img id=eh src='' border=0 style="visibility:hidden" onload="mX()" onerror="lO()">
        </body>

</html>