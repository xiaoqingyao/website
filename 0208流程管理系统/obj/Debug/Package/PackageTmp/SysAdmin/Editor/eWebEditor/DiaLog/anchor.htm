<html> <head> <meta http-equiv="Content-Type" content="text/html; charset=GB2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../language/"+lang.ad+".css' type='text/css' rel='stylesheet'>");document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");document.write("<TITLE>"+lang["DlgAnchor"]+"</TITLE>");var oRange;var bl;var aM;var eE="";oRange=dialogArguments.eWebEditor.document.selection.createRange();bl=dialogArguments.eWebEditor.document.selection.type;if(bl=="Control"){aM=oRange(0).parentNode;}else{aM=oRange.parentElement();}if(aM.tagName.toUpperCase()=="A"){if(aM.href.toUpperCase()==""){eE=aM.name;lz(aM);}}function J(){d_anchor.value=eE;iY();lang.aD(document);aE();};function iY(){d_allanchor.options.length=0;var ba=dialogArguments.eWebEditor.document.body.getElementsByTagName("A");for(i=0;i<ba.length;i++){if(ba[i].href.toUpperCase()==""){d_allanchor.options[d_allanchor.options.length]=new Option(ba[i].name,ba[i].name);}}};function jV(M){var ba=dialogArguments.eWebEditor.document.body.getElementsByTagName("A");for(i=0;i<ba.length;i++){if(ba[i].href.toUpperCase()==""){if(ba[i].name==M){return ba[i];}}}return null;};function ac(){var eE=bF(d_anchor.value);if(eE==""){aQ(d_anchor,lang["DlgAnchorNoName"]);return;}oRange=dialogArguments.eWebEditor.document.selection.createRange();bl=dialogArguments.eWebEditor.document.selection.type;if(bl=="Control"){aM=oRange(0).parentNode;}else{aM=oRange.parentElement();}var lj=false;if(aM.tagName.toUpperCase()=="A"){if(aM.href.toUpperCase()==""){aM.name=eE;lj=true;}}if(!lj){var html="";if(bl=="Control"){oRange(0).outerHTML="<a id=eWebEditor_TempElement_Anchor name="+eE+">"+oRange(0).outerHTML+"</a>";}else{oRange.pasteHTML("<a id=eWebEditor_TempElement_Anchor name="+eE+">"+oRange.htmlText+"</a>");}var aB=dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Anchor");if(config.ShowBorder!="0"){aB.runtimeStyle.borderBottom="1px dashed #000000";}aB.removeAttribute("id");}window.returnValue=null;window.close();};function oq(){var fy=d_allanchor.selectedIndex;if(fy<0){alert(lang["DlgAnchorNoSelected"]);return;}var G=jV(d_allanchor.options[fy].value);if(G){lz(G);}};function pn(){var fy=d_allanchor.selectedIndex;if(fy<0){alert(lang["DlgAnchorNoSelected"]);return;}var G=jV(d_allanchor.options[fy].value);if(G){G.outerHTML=G.innerHTML;d_allanchor.options[fy]=null;}};function lz(G){var aa=dialogArguments.eWebEditor.document.body.createTextRange();aa.moveToElementText(G);aa.select();}</script> </head> <body onload="J()"> <table border=0 cellpadding=0 cellspacing=5 id=ar><tr><td> <TABLE CELLSPACING="0" cellpadding="5" border="0" align=center> <TR valign="top"> <TD noWrap align="left"> <span lang=DlgAnchorName></span>:<br> <INPUT TYPE=TEXT SIZE=20 id="d_anchor" style="width:150px;"><br> <span lang=DlgAnchorOther></span>:<br> <select id="d_allanchor" size=8 style="width:150px;" onchange="d_anchor.value=this.options[this.selectedIndex].value;"></select> </td> <td noWrap height="100%"> <table border=0 cellpadding=0 cellspacing=0 height="100%"> <tr> <td height="50%" valign=top> <input type=button class="dlgBtnCommon" style="margin-top:15px" name="ql" onClick="ac()" value="" lang=DlgBtnOK><br> <input type=button class="dlgBtnCommon" style="margin-top:5px" name="pm" onClick="window.close()" value="" lang=DlgBtnCancel><br> </td> </tr> <tr> <td height="50%" valign=bottom> <input type=button class="dlgBtnCommon" name="qn" onClick="oq()" value="" lang=DlgBtnGoto><br> <input type=button class="dlgBtnCommon" style="margin-top:5px" name="qj" onClick="pn()" value="" lang=DlgBtnDel><br> </td> </tr> </table> </td> </tr> </table> </td></tr></table> </body> </html>