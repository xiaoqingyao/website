<HTML> <HEAD> <meta http-equiv="Content-Type" content="text/html; charset=GB2312"> <script type="text/javascript" src="dialog.js"></script> <script type="text/javascript">document.write("<link href='../language/"+lang.ad+".css' type='text/css' rel='stylesheet'>");document.write("<link href='../skin/"+config.Skin+"/dialog.css' type='text/css' rel='stylesheet'>");document.write("<TITLE>"+lang["DlgFile"]+"</TITLE>");var aJ=((parseFloat(config.AllowFileSize)>0)?true:false);function ax(al){if(al=="url"){d_fromurl.disabled=false;if(config.AllowBrowse=="1"){d_browse.disabled=false;}d_checkfromurl.checked=true;if(aJ){d_checkfromfile.checked=false;document.myuploadform.uploadfile.disabled=true;}}else{d_checkfromurl.checked=false;document.myuploadform.uploadfile.disabled=false;d_checkfromfile.checked=true;d_fromurl.disabled=true;if(config.AllowBrowse=="1"){d_browse.disabled=true;}}};function UploadError(aT){cp();ax('file');ah.style.display="none";try{aQ(document.myuploadform.uploadfile,fo(aT,config.AllowFileExt,config.AllowFileSize));}catch(e){}};function UploadSaved(co){d_fromurl.value=co;bi();};function bi(){var url=d_fromurl.value;var mc=eD(url);var ke=cZ("sysimage/icon16/"+mc);dialogArguments.insertHTML("<img id=eWebEditor_TempElement_Img border=0 src='"+ke+"'><a id=eWebEditor_TempElement_Href href='"+url+"' target=_blank>"+d_filename.value+"</a>");var aB=dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Img");aB.src=ke;aB.removeAttribute("id");aB=dialogArguments.eWebEditor.document.getElementById("eWebEditor_TempElement_Href");aB.href=url;aB.removeAttribute("id");window.returnValue=null;window.close();};function ac(){if(d_checkfromurl.checked){lF(d_fromurl.value,"/");bi();}else{if(!dU(document.myuploadform.uploadfile.value,config.AllowFileExt)){UploadError("ext");return false;}lF(document.myuploadform.uploadfile.value,"\\");cf();ah.style.display="";document.myuploadform.submit();}};function cf(){d_checkfromfile.disabled=true;d_checkfromurl.disabled=true;d_fromurl.disabled=true;if(config.AllowBrowse=="1"){d_browse.disabled=true;}Ok.disabled=true;};function cp(){d_checkfromfile.disabled=false;d_checkfromurl.disabled=false;d_fromurl.disabled=false;if(config.AllowBrowse=="1"){d_browse.disabled=false;}Ok.disabled=false;};function eD(url){var cT;cT=url.substr(url.lastIndexOf(".")+1);cT=cT.toUpperCase();var P;switch(cT){case "TXT":P="txt.gif";break;case "CHM":case "HLP":P="hlp.gif";break;case "DOC":P="doc.gif";break;case "PDF":P="pdf.gif";break;case "MDB":P="mdb.gif";break;case "GIF":P="gif.gif";break;case "JPG":P="jpg.gif";break;case "BMP":P="bmp.gif";break;case "PNG":P="png.gif";break;case "ASP":case "JSP":case "JS":case "PHP":case "PHP3":case "ASPX":P="code.gif";break;case "HTM":case "HTML":case "SHTML":P="htm.gif";break;case "ZIP":P="zip.gif";break;case "RAR":P="rar.gif";break;case "EXE":P="exe.gif";break;case "AVI":P="avi.gif";break;case "MPG":case "MPEG":case "ASF":P="mp.gif";break;case "RA":case "RM":P="rm.gif";break;case "MP3":P="mp3.gif";break;case "MID":case "MIDI":P="mid.gif";break;case "WAV":P="audio.gif";break;case "XLS":P="xls.gif";break;case "PPT":case "PPS":P="ppt.gif";break;case "SWF":P="swf.gif";break;default:P="unknow.gif";break;}return P;};function lF(url,cu){d_filename.value=url.substr(url.lastIndexOf(cu)+1);};function J(){lang.aD(document);if(!aJ){ax("url");}else{ax("file");}aE();}</script> <BODY onload="J()"> <table border=0 cellpadding=0 cellspacing=5 id=ar><tr><td> <table border=0 cellpadding=0 cellspacing=0 align=center> <tr> <td> <fieldset> <legend><span lang=DlgFileSource></span></legend> <table border=0 cellpadding=5 cellspacing=0 width="100%"> <tr><td> <table border=0 cellpadding=0 cellspacing=0 width="300px"><tr><td></td></tr></table> <table border=0 cellpadding=0 cellspacing=2 width="100%"> <script type="text/javascript">if(aJ){document.write("<tr>");document.write("<td noWrap width=\"20%\"><input type=radio id=\"d_checkfromfile\" value=\"1\" onclick=\"ax('file')\"><label for=d_checkfromfile>"+lang["DlgFromFile"]+"</label>:</td>");document.write("<td noWrap width=\"80%\">");document.write(fG("file"));document.write("</td>");document.write("</tr>");}</script> <tr> <td noWrap width="20%"><input type=radio id="d_checkfromurl" value="1" onclick="ax('url')"><label for=d_checkfromurl><span lang=DlgFromUrl></span></label>:</td> <td noWrap width="80%"> <script type="text/javascript">if(config.AllowBrowse=="1"){document.write("<table border=0 cellpadding=0 cellspacing=0 width='100%'><tr><td width='100%'><input type=text id='d_fromurl' style='width:100%' size=20 value='http://'></td><td><input class='dlgBtnBrowse' type=button id='d_browse' onclick=\"fA('file','fromurl')\"  value='"+lang["DlgBtnBrowse"]+"' align=absmiddle></td></tr></table>");}else{document.write("<input type=text id='d_fromurl' style='width:100%' size=40 value='http://'>");}</script> </td> </tr> </table> </td></tr> </table> </fieldset> </td> </tr> <tr><td height=5></td></tr> <tr><td noWrap align=right><input type=submit class="dlgBtnCommon" value='' id=Ok onclick="ac()" lang=DlgBtnOK>&nbsp;&nbsp;<input type=button class="dlgBtnCommon" value='' onclick="window.close();" lang=DlgBtnCancel></td></tr> </table> </td></tr></table> <div id=ah style="width:200px;height:30px;position:absolute;left:70px;top:30px;display:none"> <table border=0 cellpadding=0 cellspacing=1 bgcolor="#000000" width="100%" height="100%"><tr><td bgcolor=#3A6EA5><marquee align="middle" behavior="alternate" scrollamount="5"><font color=#FFFFFF><span lang=DlgComUploading></span></font></marquee></td></tr></table> </div> <input type=hidden id=d_filename value=""> </body> </html> 